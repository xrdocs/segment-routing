Segment Routing Clarence Filsfils Cisco Fellow @ cisco Systems November 2015 Kris Michielsen Technical Leader Engineering @ cisco Systems Segment Routing Introduction Clarence Filsfils Kris Michielsen Illustration and Examples Conventions The examples in this presentation follow these conventions Router-id of NodeX 1.1.1.X Link address XY Prefix-SID index of NodeX X Prefix-SIDs are labels in the range 16000 23999 This is the default Segment Routing Global Block (SRGB) Adjacency-SIDs are labels with the format 24NXY for the Nth adjacency X Y LDP RSVP BGP3107 labels are in the range 90000 99999 IPv4 99.X.Y.X 24 with X Y IPv6 99 X Y X 112 with X Y and X Y in decimal representation 2015 Cisco and or its affiliates. All rights reserved. 3 Segment Routing Source Routing the source chooses a path and encodes it in the packet header as an ordered list of segments the rest of the network executes the encoded instructions Segment an identifier for any type of instruction forwarding or service In this presentation IGP-based forwarding construct 2015 Cisco and or its affiliates. All rights reserved. 4 Segment Routing Forwarding Plane MPLS an ordered list of segments is represented as a stack of labels Segment Routing re-uses MPLS data plane without any change Segment represented as MPLS label Applicable to IPv4 and IPv6 address families IPv6 an ordered list of segments is encoded in a routing extension header This presentation MPLS data plane 2015 Cisco and or its affiliates. All rights reserved. 5 Global and Local Segments Global Segment Any node in SR domain understands associated instruction Each node in SR domain installs the associated instruction in its forwarding table MPLS global label value in Segment Routing Global Block (SRGB) Local Segment Only originating node understands associated instruction MPLS locally allocated label 2015 Cisco and or its affiliates. All rights reserved. 6 Global Segments Global Label Indexes Global Segments always distributed as a label range (SRGB) + Index Index must be unique in Segment Routing Domain Best practice same SRGB on all nodes Global model requested by all operators Global Segments are global label values simplifying network operations Default SRGB 16 000 23 999 Other vendors also use this label range 2015 Cisco and or its affiliates. All rights reserved. 7 IGP segments Two basic building blocks distributed by IGP Prefix Segments Adjacency Segments 2015 Cisco and or its affiliates. All rights reserved. 8 IGP Prefix Segment Shortest-path to the IGP prefix Equal Cost MultiPath (ECMP)-aware Global Segment Label 16000 + Index Advertised as index Distributed by ISIS OSPF 1.1.1.5 32 16005 5 16005 2 16005 16005 4 1 16005 16005 3 16005 All nodes use default SRGB 16 000 23 999 2015 Cisco and or its affiliates. All rights reserved. 9 IGP Prefix Segment Shortest-path to the IGP prefix Equal Cost MultiPath (ECMP)-aware Global Segment Label 16000 + Index Advertised as index Distributed by ISIS OSPF 16004 16004 1 16004 16004 3 2 4 All nodes use default SRGB 16 000 23 999 16004 16004 5 1.1.1.4 32 16004 2015 Cisco and or its affiliates. All rights reserved. 10 IGP Adjacency Segment Forward on the IGP adjacency Local Segment Advertised as label value Distributed by ISIS OSPF 1 Adj to 4 24024 3 Adj to 5 24025 5 2 4 All nodes use default SRGB 16 000 23 999 2015 Cisco and or its affiliates. All rights reserved. 11 Combining IGP Segments Steer traffic on any path through the network Path is specified by list of segments in packet header a stack of labels No path is signaled No per-flow state is created Single protocol IS-IS or OSPF 1 3 All nodes use default SRGB 16 000 23 999 16004 24045 Packet to 5 24045 Packet to 5 2 4 5 16004 24045 2015 Cisco and or its affiliates. All rights reserved. 12 Visit us cisco.com segment-routing.net Acknowledgements Ahmed Bashandy Robert Hanzl Steven Luong Stefano Previdi Peter Psenak Thank you. 